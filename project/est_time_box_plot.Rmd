---
title: "est_time_box_plot.rmd"
output: html_notebook
---

```{r}
library(tidyverse)
library(reshape2)
library(lubridate)

days_of_week <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday")
```

```{r}
head(rides_df)
```


```{r}
for (i in 1:14) {
  mean <- rides[[i]] %>%
    summarise(mean = mean(SPOSTMIN, na.rm=T)) %>%
    round(digits = 2)
  print(paste("The average wait time for ", names(rides[i]), " is ", mean, sep = ""))
}
```


```{r}
for (i in 1:14) {
  mean <- rides[[i]] %>%
    summarise(mean = mean(SACTMIN, na.rm=T)) %>%
    round(digits = 2)
  print(paste("The real average wait time for ", names(rides[i]), " is ", mean, sep = ""))
}
```


```{r}
rides_df %>%
  filter(datetime > as.POSIXct("2018-06-30")) %>%
  ggplot(aes(x = SPOSTMIN, y = ride_name)) +
  geom_boxplot(na.rm = TRUE, outlier.shape = "circle", outlier.alpha = .1, size = 1) + 
  coord_cartesian(xlim = c(0,275)) +
  geom_vline(xintercept = c(30, 60, 90, 120), color = c("green", "yellow", "orange", "red"), size = 1)
```


```{r}
rides_df %>% group_by(ride_name) %>%
  filter(datetime > as.POSIXct("2018-06-30")) %>%
  ggplot(aes(x = SACTMIN, y = ride_name)) +
  geom_boxplot(na.rm = TRUE, outlier.shape = "circle", outlier.alpha = .1, size = 1) +
  coord_cartesian(xlim = c(0, 200)) +
  geom_vline(xintercept = c(30, 60, 90, 120), color = c("green", "yellow", "orange", "red"), size = 1)
```
# Compare Wait times for indoor and Splash Apect rides with Temp and precipitation levels

# Wait times for parades -- 

# Largest average wait times = busiest day of week -- Histogram of wait times highlight parade times
```{r}
for (i in 1:14) {
  chart <- rides[[i]] %>%
    mutate(weekday = weekdays(datetime)) %>%
    group_by(weekday) %>%
    summarise(mean_wait = mean(SPOSTMIN, na.rm = TRUE)) %>%
    ggplot(aes(x = ordered(weekday, levels = days_of_week), y = mean_wait)) +
    geom_col() +
    coord_cartesian(ylim = c(0, 150)) +
    labs(title = names(rides[i]))
  print(chart)
}
```


```{r}
rides_df %>%
  mutate(weekday = weekdays(datetime)) %>%
  group_by(weekday, ride_name) %>%
  summarise(mean_wait = mean(SPOSTMIN, na.rm = TRUE)) %>%
  ggplot(aes(x = ordered(weekday, levels = days_of_week), y = mean_wait, fill = ride_name), color = as.factor(ride_name)) +
  geom_col()
```


```{r}
rides_df %>%
  filter()
  mutate(weekday = weekdays(datetime)) %>%
  group_by(weekday, ride_name) %>%
  summarise(mean_wait = mean(SPOSTMIN, na.rm = TRUE)) %>%
  ggplot(aes(x = ordered(weekday, levels = days_of_week), y = mean_wait, fill = ride_name), color = as.factor(ride_name)) +
  geom_col()
```

